# ChatTTS 音色种子参考说明

本文档基于 `testtts.py` 中的注释说明，提供 ChatTTS 音色种子的详细参考信息。

## 音色种子说明

ChatTTS 使用种子 (seed) 参数来控制音色特征，不同的种子会产生不同的声音特点。

### 男性音色 (Male Voices)

| 种子 | 年龄 | 风格 | 描述 |
|------|------|------|------|
| 111 | 年轻 | 文学 (Literary) | 适合年轻男性，声音有文学气质 |
| 333 | 年轻 | 温柔 (Gentle) | 适合年轻男性，声音温柔 |
| 666 | 中年 | 白领 (White-collar) | 适合中年男性，声音专业 |
| 7777 | 中年 | 港式 (Hong Kong-style) | 适合中年男性，港式发音风格 |
| 9999 | 中年 | 深沉有共鸣 (Deep and resonant) | 适合中年男性，声音深沉有力 |

### 女性音色 (Female Voices)

| 种子 | 年龄 | 风格 | 描述 |
|------|------|------|------|
| 2 | 年轻 | 情感丰富 (Emotionally rich) | 适合年轻女性，声音富有情感表现力 |
| 4 | 中年 | 深情 (Deeply emotional) | 适合中年女性，声音深情动人 |
| 1111 | 中年 | 清澈纯净 (Clear and pure) | 适合中年女性，声音清澈纯净 |
| 3333 | 中年 | 平静宁静 (Calm and serene) | 适合中年女性，声音平静安详 |

## 系统实现

### 1. 基础映射 (chattts_engine.py)

系统内置了性别、性格到种子的映射关系：

```python
self.voice_seeds = {
    'female': {
        'young': '2',          # 年轻，情感丰富
        'middle-aged': '4',     # 中年，深情
        'mature': '1111',      # 中年，清澈纯净
        'professional': '3333', # 中年，平静宁静
        'gentle': '2',          # 情感丰富
        'emotionally rich': '2', # 情感丰富
        'deeply emotional': '4', # 深情
        'clear and pure': '1111', # 清澈纯净
        'calm and serene': '3333'  # 平静宁静
    },
    'male': {
        'young': '111',        # 年轻，文学
        'middle-aged': '666',  # 中年，白领
        'mature': '7777',      # 中年，港式
        'professional': '666', # 中年，白领
        'literary': '111',     # 文学
        'gentle': '333',       # 温柔
        'white-collar': '666', # 白领
        'hong kong-style': '7777', # 港式
        'deep and resonant': '9999' # 深沉有力
    }
}
```

### 2. 智能种子选择

系统集成了智能种子选择器 (`seed_database.py`)，可以根据角色特征自动选择最适合的种子：

- 角色名称一致性：同一角色始终使用相同的种子
- 性别匹配：根据角色性别选择合适的种子范围
- 性格特征：根据角色性格选择对应的音色风格

### 3. 使用方式

在播客生成系统中，音色种子通过以下方式应用：

```python
# 在音频生成时自动选择种子
seed = engine._get_character_seed(
    character_name="小红",    # 角色名
    gender="female",          # 性别
    personality="gentle"      # 性格
)

# 通过 subprocess 调用 chattts 命令
command = f'chattts -s {seed} "{processed_text}"'
```

## 推荐配置

### 角色类型推荐

1. **新闻主播**：
   - 男性：666 (中年白领 - 专业稳重)
   - 女性：3333 (中年平静 - 专业清晰)

2. **故事讲述者**：
   - 男性：111 (年轻文学 - 富有表现力)
   - 女性：2 (年轻情感丰富 - 生动活泼)

3. **访谈主持人**：
   - 男性：9999 (中年深沉 - 权威可信)
   - 女性：1111 (中年清澈 - 亲切自然)

4. **教学讲解**：
   - 男性：333 (年轻温柔 - 耐心细致)
   - 女性：4 (中年深情 - 温暖亲切)

## 技术实现细节

### 命令行调用格式

```bash
chattts -s <种子> "文本内容"
```

例如：
```bash
chattts -s 2 "你好今天天气怎么样呀"
```

### 文本预处理

为避免命令行解析问题，系统会自动预处理文本：
- 移除空格
- 移除标点符号
- 移除特殊字符
- 确保文本编码正确

### 输出处理

- ChatTTS 默认生成 `tts.wav` 文件
- 系统自动重命名为带时间戳的唯一文件名
- 支持音频文件管理和清理

## 注意事项

1. **种子一致性**：同一角色应始终使用相同种子以确保音色一致
2. **文本限制**：单次生成的文本不宜过长，建议控制在200字符以内
3. **编码问题**：中文文本需要正确处理UTF-8编码
4. **系统兼容**：确保系统中已正确安装 chattts 命令行工具

## 更新日志

- **2025-10-19**: 基于 testtts.py 实现 subprocess 调用方式
- **2025-10-19**: 添加音色种子详细映射表
- **2025-10-19**: 集成智能种子选择功能